<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3>
<p>あなたはタイル <var>1</var> からタイル <var>N</var> までの番号が付けられている <var>N</var> 枚のタイルを持っている．各タイルの表面の色と裏面の色は黒色または白色である．ここで，黒色は文字 <code>B</code> で表し，白色は文字 <code>W</code> で表すことにする．
タイル <var>i</var> (<var>1 \leqq i \leqq N</var>) の表面の色は，文字列 <var>S</var> の <var>i</var> 文字目で表される色である．
タイル <var>i</var> (<var>1 \leqq i \leqq N</var>) の裏面の色は，文字列 <var>T</var> の <var>i</var> 文字目で表される色である．</p>
<p>ウズベキスタンはタイル装飾による歴史的建築で有名な国である．ウズベキスタンのモスクやマドラサを訪れたあなたはそれらの美しい建築に魅了され，タイルに関する奇妙な機械を購入した．この機械は左側と右側に台を持ち，それぞれの台に <var>1</var> 枚ずつタイルを置くことで，置いた <var>2</var> 枚のタイルと引き換えに新しいタイルを <var>1</var> 枚受け取ることができる．
左側の台に置いたタイルを <var>a</var>，右側の台に置いたタイルを <var>b</var> としたとき，<var>2</var> 枚のタイル <var>a, b</var> と引き換えに受け取ることができる新しいタイル <var>c</var> は以下の条件を満たす．</p>
<ul>
<li> <var>c</var> の表面の色は，<var>a</var> の裏面の色と <var>b</var> の表面の色が同じとき黒色であり，そうでないとき白色である．
<li> <var>c</var> の裏面の色は，<var>a</var> の表面の色と <var>b</var> の裏面の色が同じとき黒色であり，そうでないとき白色である．
</ul>

<p>あなたは <var>N</var> 枚のタイルと奇妙な機械を用いて，<var>Q</var> 日間にわたり次のような行動を行うことにした．<var>j</var> 日目 (<var>1 \leqq j \leqq Q</var>) に行う行動は以下のパターン <var>1</var> かパターン <var>2</var> のいずれかである．</p>
<ul>
<li> パターン <var>1</var>：タイル <var>X_j</var> の表面の色を文字 <var>Y_j</var> で表される色に変更する．また，タイル <var>X_j</var> の裏面の色を文字 <var>Z_j</var> で表される色に変更する．ただし，<var>Y_j, Z_j</var> は `B`, `W` のいずれかである．
<li> パターン <var>2</var>：タイル <var>L_j, L_j + 1, \dots, R_j</var> をこの順に左から右へ一列に並べる．この列に対して，以下の操作を <var>0</var> 回以上 <var>R_j - L_j</var> 回以下の好きな回数行うことで，列の中で表面が白色であるタイルをちょうど <var>M_j</var> 枚にできるかを判定する思考実験を行う．
<ul>
<li> 列の中で隣り合う <var>2</var> 枚のタイルを選んでそれらを列から取り除く．選んだ <var>2</var> 枚のタイルのうち，列において左側に置かれていたタイルを機械の左側の台に置き，右側に置かれていたタイルを機械の右側の台に置くことで，置いた <var>2</var> 枚のタイルと引き換えに新しいタイルを受け取る．そして，列の中で元々 <var>2</var> 枚のタイルがあった場所に，受け取った <var>1</var> 枚のタイルを入れる．
</ul>
</ul>

<p>タイルの情報と行動の情報が与えられたとき，パターン <var>2</var> の行動の結果を求めるプログラムを作成せよ．</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>入力は以下の形式で標準入力から与えられる．</p>
<pre><var>N</var>
<var>S</var>
<var>T</var>
<var>Q</var>
<var>(\text{Query }1)</var>
<var>(\text{Query }2)</var>
<var>\vdots</var>
<var>(\text{Query }Q)</var>
</pre>
<p>各 <var>(\text{Query }j)</var> (<var>1 \leqq j \leqq Q</var>) にはいくつかの整数や文字が空白区切りで書かれている．そのうち最初に書かれているものは整数 <var>1, 2</var> のいずれかであり，これを <var>P_j</var> とすると，この行の内容は以下のいずれかである．</p>
<ul>
<li><var>P_j = 1</var> のとき，この行には続いて <var>1</var> 個の整数 <var>X_j</var> と <var>2</var> 個の文字 <var>Y_j, Z_j</var> がこの順に書かれている．これはあなたが <var>j</var> 日目に取る行動がパターン <var>1</var> であり，タイル <var>X_j</var> の表面の色を文字 <var>Y_j</var> で表される色に変更し，タイル <var>X_j</var> の裏面の色を文字 <var>Z_j</var> で表される色に変更することを表す．ただし，<var>Y_j, Z_j</var> は <code>B</code>, <code>W</code> のいずれかである．</li>
<li><var>P_j = 2</var> のとき，この行には続いて <var>3</var> 個の整数 <var>L_j, R_j, M_j</var> がこの順に書かれている．これはあなたが <var>j</var> 日目に取る行動がパターン <var>2</var> であり，タイル <var>L_j, L_j + 1, \dots, R_j</var> をこの順に左から右へ一列に並べ，この列に対して操作を行い，列の中で表面が白色であるタイルをちょうど <var>M_j</var> 枚にすることができるかを判定する思考実験を行うことを表す．</li>
</ul>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p><var>P_j = 2</var> となる <var>j</var> (<var>1 \leqq j \leqq Q</var>) それぞれに対して，列の中で表面が白色であるタイルをちょうど <var>M_j</var> 枚にすることができるとき <code>Yes</code> を，そうでないとき <code>No</code> を，<var>j</var> の昇順に改行区切りで出力せよ．</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>制約</h3>
<ul>
<li><var>1 \leqq N \leqq 300\,000</var>．</li>
<li><var>S</var> は <code>B</code>, <code>W</code> からなる長さ <var>N</var> の文字列である．</li>
<li><var>T</var> は <code>B</code>, <code>W</code> からなる長さ <var>N</var> の文字列である．</li>
<li><var>1 \leqq Q \leqq 300\,000</var>．</li>
<li><var>P_j</var> は <var>1,2</var> のいずれかである (<var>1 \leqq j \leqq Q</var>)．</li>
<li><var>P_j = 1</var> のとき，<var>1 \leqq X_j \leqq N</var> (<var>1 \leqq j \leqq Q</var>)．</li>
<li><var>P_j = 1</var> のとき，<var>Y_j</var> は <code>B</code>, <code>W</code> のいずれかである (<var>1 \leqq j \leqq Q</var>)．</li>
<li><var>P_j = 1</var> のとき，<var>Z_j</var> は <code>B</code>, <code>W</code> のいずれかである (<var>1 \leqq j \leqq Q</var>)．</li>
<li><var>P_j = 2</var> のとき，<var>1 \leqq L_j \leqq R_j \leqq N</var> (<var>1 \leqq j \leqq Q</var>)．</li>
<li><var>P_j = 2</var> のとき，<var>0 \leqq M_j \leqq R_j - L_j + 1</var> (<var>1 \leqq j \leqq Q</var>)．</li>
<li><var>N, Q, P_j, X_j, L_j, R_j, M_j</var> はすべて整数である．</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>小課題</h3>
<ol>
<li>(<var>6</var> 点) <var>N \leqq 6</var>．</li>
<li>(<var>10</var> 点) <var>N \leqq 100</var>，<var>P_j = 2</var> (<var>1 \leqq j \leqq Q</var>)．</li>
<li>(<var>9</var> 点) <var>N \leqq 500</var>，<var>P_j = 2</var> (<var>1 \leqq j \leqq Q</var>)．</li>
<li>(<var>8</var> 点) <var>N \leqq 1\,700</var>，<var>P_j = 2</var> (<var>1 \leqq j \leqq Q</var>)．</li>
<li>(<var>23</var> 点) <var>N \leqq 10\,000</var>，<var>Q \leqq 10\,000</var>．</li>
<li>(<var>14</var> 点) <var>N \leqq 100\,000</var>，<var>Q \leqq 100\,000</var>．</li>
<li>(<var>30</var> 点) 追加の制約はない．</li>
</ol>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>4
WBWB
BWBB
5
2 3 4 1
2 1 2 0
1 3 B B
2 3 4 2
2 2 4 1
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>Yes
Yes
No
Yes
</pre>
<p><var>1</var> 日目の行動について，タイル <var>3, 4</var> をこの順に左から右へ一列に並べる．操作を <var>1</var> 回も行わない場合，タイル <var>3</var> のみ表面が白色であるため，列の中で表面が白色であるタイルをちょうど <var>1</var> 枚にすることができる．したがって，<code>Yes</code> を出力する．</p>
<p><var>2</var> 日目の行動について，タイル <var>1, 2</var> をこの順に左から右へ一列に並べる．タイル <var>1</var> とタイル <var>2</var> を選んで操作を <var>1</var> 回行う場合，操作した後の列は <var>1</var> 枚のタイルを含む．このタイルの表面と裏面は共に黒色であるため，列の中で表面が白色であるタイルをちょうど <var>0</var> 枚にすることができる．したがって，<code>Yes</code> を出力する．</p>
<p><var>3</var> 日目の行動について，タイル <var>3</var> の表面の色と裏面の色を共に黒色に変更する．</p>
<p><var>4</var> 日目の行動について，タイル <var>3, 4</var> をこの順に左から右へ一列に並べる．操作によって，列の中で表面が白色であるタイルをちょうど <var>2</var> 枚にすることはできないことが証明できる．したがって，<code>No</code> を出力する．</p>
<p><var>5</var> 日目の行動について，タイル <var>2, 3, 4</var> をこの順に左から右へ一列に並べる．タイル <var>3</var> とタイル <var>4</var> を選んで操作を <var>1</var> 回行う場合，操作した後の列は <var>2</var> 枚のタイルを含む．左側にあるタイルはタイル <var>2</var> であり，右側にあるタイルの表面と裏面は共に黒色である．この <var>2</var> 枚のタイルを選んでさらに操作を <var>1</var> 回行う場合，操作した後の列は <var>1</var> 枚のタイルを含む．このタイルの表面は白色で，裏面は黒色であるため，列の中で表面が白色であるタイルをちょうど <var>1</var> 枚にすることができる．したがって，<code>Yes</code> を出力する．</p>
<p>この入力例は小課題 <var>1,5,6,7</var> の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>6
BWBWWB
WBWBBB
8
2 1 3 2
2 2 6 0
2 1 5 3
2 3 3 0
2 3 4 1
2 5 6 2
2 2 6 4
2 1 4 2
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>No
Yes
Yes
Yes
Yes
No
No
Yes
</pre>
<p>この入力例はすべての小課題の制約を満たす．</p></section>
</div>
</span>
</span>
